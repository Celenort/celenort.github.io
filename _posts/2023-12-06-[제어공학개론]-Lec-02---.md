---
layout: post
date: 2023-12-06
title: "[제어공학개론] Lec 02 - "
tags: [lecture-note, system, from_velog, ]
categories: [Electrical Engineering, control theory, ]
media_subpath: assets/img/2023-12-06-[제어공학개론]-Lec-02---.md
image:
  path: 0.png
  alt:  
description: 제어공학에서 Transfer Function(TF)의 개념과 모델링 방법을 다루며, TF의 종류(유리 함수, 적절한 함수, 시간 지연 시스템)와 연결 방식(직렬, 병렬, 피드백 시스템)을 설명합니다. Laplace 변환을 이용한 TF 계산 방법과 임펄스 응답, 부분 분수 전개를 통한 출력 계산도 포함되어 있으며, TF를 통해 시스템의 동작을 이해하는 데 도움을 줍니다. 결론적으로, TF의 변환과 출력 계산 방법을 학습하고, 다음 강의에서는 Bode plot과 선형화에 대해 다룰 예정입니다.
pin: false
---


![0](/0.png)


# 📢Precaution


> 본 게시글은 서울대학교 심형보 교수님의 제어공학개론 수업 내용을 바탕으로 작성되었습니다.

- 배경지식 : 신호 및 시스템 - Transfer function, 공학수학 - Laplace transform

# Modeling의 방법


지난 시간까지는 왜 Control에 대한 개요와 그 중요성에 대해 알아보았다면, 이번에는 현실에 존재하는 물리법칙을 따르는 system을 어떻게 하면 수식의 세계로, 우리가 계산하고 제어 가능한 변수들로 modeling할 수 있는지 그 방법들에 대해 간단히 살펴보고자 합니다.


### Differential Equation


이 방법은, 실제 시스템을 그대로 모델링하여 differential equation으로 나타낸 것입니다. 앞서 언급했던 드론의 예제에서, 뉴턴의 제 2법칙을 이용하여 식을 세웠었던 것이 기억 나시나요? 이런 방법이 differential equation입니다.


> (1)  
> $$  
> u(t)-mg = m\ddot y(t)$$


이러한 방법의 장점은, 식을 한눈에 봤을 때 물리적 의미가 드러난다는 것입니다. 그러나 differential equation은 사실 실제 제어에서 사용하는 modeling 방법이라기 보다는 후술할 Transfer function, State-space representation을 하기 위한 수식의 원형에 가깝습니다. 이 식 자체로는 여러 시스템을 직렬/병렬로 연결한다거나, 해석하기에 불편함이 따를 수밖에 없습니다. 그렇기에 아래의 방법들을 이용하여 실제 시스템을 조금 더 쉽게 다룰 수 있도록 가공하게 됩니다.


또 하나의 단점은, $u(t)$가 주어졌을 때 $y(t)$를 evaluate 하는 것이 어렵다는 점입니다. 시스템이 수행하는 동작을 따라 $y(t)$를 구하려면 식 (1)에 대입하여 $\ddot y(t)$를 알아내고 이를 2번 적분하여 얻어내는 방법밖에 없습니다. 이는 상당히 복잡하고 적분상수 등의 이슈가 있을 수 있습니다.


### Transfer Function


{% raw %}
$$
T(s) = \frac{Y(s)}{U(s)} = \frac{\mathcal{L}(y(t))}{\mathcal{L}(u(t))}
$$
{% endraw %}


Transfer function의 정의는 Input Laplace 변환 분의 Output Laplace 변환입니다. Laplace 변환 자체에 대한 이해는 공학수학 시간에 했으리라 믿고, 짧게 Laplace 변환의 정의만 살펴보도록 하겠습니다.


> If $f(t)$ is a function defined for all $t\leq 0$, its Laplace transform is in the integral of $f(t)$ times $e^{-st}$ from $t=0$ to $\infty$. It is a function of s, say, $F(s)$, and is denoted by $\mathcal{L}(f)$; thus


{% raw %}
$$
F(s) = \mathcal{L}(f) = \displaystyle\int_0^\infty e^{-st}f(t)dt$$


	Source : Kreyszig 공업수학 10th ed. p. 204


사실 Transfer function을 다루면서 Laplace 변환 자체를 다루거나 계산할 일은 크게 없습니다. 신호 및 시스템 수업을 들었다면, Transfer function이 등장하였을 것이고, 그렇지 않더라도 공학수학 시간에 Laplace transform을 배우면서 ODE를 해결하는 하나의 방법으로 $y$의 Laplace transform $Y(s)$, $r$의 Laplace transform $R(s)$의 비율 $Q$를 Inverse Laplace transform하여, Partial Fraction Expansion(PFE)를 통해 ODE의 solution을 구해내는 과정을 배웠던 기억이 있을 겁니다. 사실 제어에서 다루는 많은 부분들이 이러한 ODE를 해결하는 문제이므로, 신호의 Laplace 변환을 구하여 문제를 해결한다는 접근은 올바를 것입니다.


그러나, Transfer function은 이러한 점을 제외하고도, 시스템의 안정도를 확인하는 등 여러 유용한 정보들도 포함하고 있어서 이를 배우는 것이 제어공학을 이해하는 하나의 목표가 될 수 있습니다.


Transfer function의 장점은 differential equation과 다르게 연결이 용이하다는 점이 있습니다. 후에 다루겠지만, Plant끼리의 직렬, 병렬 연결에서 differential equation은 각각을 연결하는 변수들을 새로 지정하여 훨씬 복잡하고, 심지어는 정리도 어려운 수식이 만들어지지만, Transfer function은 아주 간단한 대수적 연산으로 이를 표현할 수 있습니다. 또다른 장점으로는, $y(t)$ 즉 Output을 evaluate 해내기가 매우 편합니다. 입력 신호 $u(t)$의 Laplace 변환을 Transfer function과 곱한 뒤 이 값을 Inverse Laplace transform 하면 됩니다. 말이 어려워 보이지만, 컴퓨터의 입장에서 볼 때 differential equation을 푸는 것 보다 훨씬 쉽게 느껴지겠죠.


물론 단점도 존재합니다. 먼저는 Transfer function 자체가 s-domain 상의 식입니다. s-domain 자체가 우리에게는 익숙한 time domain과의 성질이 많이 다르기도 하고, Transfer function만으로 해당 system이 어떤 물리적 법칙이 적용되었는지를 알기 힘듭니다.


### State-space representation


마지막으로, Transfer function을 이용한 시스템의 분석 이후 다루게 될 state-space representation(상태변수 표현법)이 있습니다. 이는 differential equation을 Matrix 형태로 모델링 한 것으로 볼 수 있는데, 여기서 중요한 개념인 'state', 상태가 등장합니다. 이에 대해서는 뒤에서 더 자세히 다루도록 할게요 😏


# Benchmark Problem : 3-cart


이 수업을 모두 들은 뒤 해결을 목표로 하는 Benchmark problem을 설정하고, 이를 해결하기 위해 여러 개념과 방법론들을 배워가는 것으로 동기부여를 할 수 있을 겁니다. 하나 하나 배울 때 마다 Naive한 접근에서부터, 점점 많은 요소들을 고려할 수 있게 되고, 결국은 해당 문제를 온전히 해결할 수 있게 될 것입니다.


![1](/1.png)


그림으로 표현된 3-cart problem을 말로 풀어서 설명해 볼게요. 질량이 $m_1, m_2, m_3$인 3개의 cart가 Spring constant가 $k_1, k_2$인 용수철에 의해 연결되어 있습니다. 또한 Damping constant $c_1, c_2, c_3$ (혹은 속력에 비례하는 마찰력의 계수)인 damper와 각각의 cart가 연결되어 있습니다. 첫 번째 cart에 우리는 $u(t)$라는 힘을 인가할 수 있을 때, 우리는 Cart 1, 2, 3가 원하는 시간에, 원하는 위치에, 원하는 속도를 가지도록 하는 $u(t)$를 찾아낼 수 있을까요? 앞선 Introduction에서 다루었듯이, 내가 $u(t)$로 밀 때 옆에서 방해하는 힘(disturbance)이 존재하거나, System 자체 variable인 $m_i, k_j, c_p$ 값들을 정확히 알지 못하는 상태에서도 제어가 가능할까요? 수업을 모두 듣고 이 글을 작성하는 시점에서, 이에 대한 대답은 "YES". 가능합니다.


조금 더 구체화시켜서, 힘을 인가하기 시작한지 10초 뒤, Cart 3이 1m 앞으로 간 상태로 정지하게 하는 제어 입력 $u(t)$는 어떻게 구할 수 있을까요? Feedback의 힘을 빌려 제어하는 법을 배워 봅시다.


### Modeling benchmark problem


가장 먼저는, 3-cart system에서 각각의 cart에 작용하는 힘에 대한 관계식을 세워볼 수 있습니다. 각각의 cart에 작용하는 힘들의 합력은 cart의 질량 $\times$ 가속도라는 뉴턴의 제 2법칙을 이용해 modeling 해보면,


> $$\begin{aligned}  
> m_1 \ddot p_1 &= u(t)-k_1(p_1-p_2)-c_1\dot p_1\\  
> m_2 \ddot p_2 &= k_1 (p_1-p_2) -k_2 (p_2-p_3) -c_2 \dot p_2\\  
> m_2 \ddot p_2 &= k_1 (p_1-p_2) -k_2 (p_2-p_3) -c_2 \dot p_2\\  
> m_3 \ddot p_3 &= k_2 (p_2-p_3) -c_3 \dot p_3\\  
> y &= p_3  
> \end{aligned}$$


우리가 알고 싶은 것(혹은 출력)은 3번째 cart의 위치이므로 $y=p_3$라고 할 수 있습니다. 각 cart 간의 용수철 힘의 방향이 모호할 수 있는데, 저 같은 경우는 이러한 생각의 과정을 따릅니다.


기본적으로 왼쪽 방향을 ( + ) 방향으로 놓았다는 사실을 인지한 상태에서 ,일단 방향을 고려하지 않고 $p_1-p_2$의 index 순서대로 쓴 다음, $p_1$이 더 왼쪽으로 가면, $p_1$이 커지는 방향이고, $p_1-p_2$의 값은 양의 방향으로 증가합니다. 이 때 두 Cart 간의 거리는 증가하므로 Cart 1은 오른쪽(음의 방향)으로 받는 힘이 커집니다. 변위에 곱해질 값은 $-k_1$이 되겠습니다.


Damping의 경우는 항상 운동방향의 반대로 작용하므로 ( - )를 붙였다고 생각하면 편하겠습니다.


이러한 Modeling에서 우리가 사용한 것은 뉴턴의 제 2법칙 입니다. 이외에도 용수철 힘은 용수철 상수와 변위의 곱이라는 사실도 이용했습니다. 이로부터, Modeling에는 그 대상에 대한 Field Knowledge가 반드시 선행되어야지만 가능합니다. 또다른 예시로 탄도학(Ballistics)을 모델링 하려면, 단순히 $F=ma$만 알고 있으면 안되겠지요. 유체역학적 지식과, 속도 조건에 따라 아음속, 혹은 초음속에서의 압축성 유동에 대한 Field Knowledge가 있어야지만 올바르게 이를 모델링할 수 있을 것입니다.


# Transfer function


입력 $u$를 받아 $y$를 출력하는 시스템이 대한 Transfer function은 다음과 같이 기술됩니다.


> $$  
> T_{u\rightarrow y}(s) := \displaystyle\frac{{\mathcal L}(y(t))}{{\mathcal L}(u(t))} = {Y(s) \over U(s)}$$


Transfer function은 모든 초깃값이 0일 때의 출력 신호의 라플라스 변환을 입력 신호의 라플라스 변환으로 나눈 것으로 정의됩니다. 이 때 모든 초깃값이 0이라는 점은, 입력 신호 $u(t)\equiv 0$ for $t<0$을 의미합니다. 입력 신호가 $0$이므로, 당연히도 출력값 $y(t)$도 0을 가리킬 것입니다.


### Differential Eqn to Transfer function


그렇다면, Differential Equation이 주어졌을 때 Transfer function을 실제로 계산해 보겠습니다. 다음과 같은 Differential Equation을 생각해봅시다.


> $$  
> a_n y^{(n)}(t) + \cdots + a_1 y^{(1)}(t) + a_0 y(t) = b_m u^{(m)}(t)+ \cdots + b_1 u^{(1)}(t)+b_0 u(t)$$


굉장히 복잡해 보이지만, $y$의 최대 n차 도함수와 $u$의 최대 m차 도함수간에 선형적인 결합으로 이루어진 differential equation입니다. 양변을 Laplace transform 하기 전에, derivative에 대한 Laplace transform의 성질을 알고 가야겠지요.


> (2)  
> $$  
> \text{let } {\mathcal L}\{y(t)\}=Y(s)\\{\mathcal L}(\dot y)= sY(s)-y(0^-)$$


초깃값은 Transfer function의 조건 때문에 0으로 둘 수 있겠습니다. 이 때 초깃값은 $y(0^-)$로 0보다 살짝 왼쪽의 값으로 써주었는데, 이는 $0+, 0-$ 양쪽 방향에서 Direc's Delta function을 극한으로 보낼 때 값을 보정하기 위함이라, 굳이 알 필요는 없습니다.


식 (2)로부터 알 수 있는 사실은 time domain에서의 미분은, s-domain에서 본래의 함수에 s를 곱하는 것으로 처리된다는 점입니다. 정의부터, 계산까지 하나같이 어려운 미분을 s-domain에서 이렇게 쉽게 퉁칠 수 있다는 점이, s-domain의 장점으로 정말 크게 체감되는 것 같습니다.


> $$  
> \text{let } {\mathcal L}\{y(t)\}=Y(s),{\mathcal L}\{u(t)\}=U(s)\\  
> \bigg(a_n s^n + \cdots + a_1 s + a_0 \bigg)Y(s) = \bigg(b_m s^m + \cdots + b_1 s + b_0 \bigg)U(s)\\  
> \therefore T_{u\rightarrow y} =\displaystyle\frac{Y(s)}{U(s)}= \frac{\displaystyle\sum_{j=0}^m b_j s^j}{\displaystyle\sum_{i=0}^n a_i s^i}$$


신기하게도 원래의 ODE의 입/출력의 n계도함수의 계수들로 이루어진 polynomial이 Transfer function의 분자와 분모를 이루고 있음을 알 수 있습니다. 물론, 계산 과정에서 원래의 differential equation의 출력 $y(t)$와 그 도함수들의 계수 $a_i$는 Transfer function의 분모로, 입력 $u(t)$와 그 도함수들의 계수 $b_j$는 Transfer function의 분자로 이동한 것을 알 수 있습니다.


Transfer function은 선형이고, 시불변일 때 (Linear, Time Invarient) 그 값이 일정합니다. 여기서 선형(Linear), 시불변(Time Invarient)라는 2가지 조건에서 Transfer function이 일정한 값을 가지며 제대로 사용이 가능한데, 각각을 모두 만족해야 합니다. 이를 짧게 줄여 LTI system이라고 합니다.


### 선형(Linear)


시스템이 선형이라는 것은, 수학에서의 선형성의 조건과 많이 흡사합니다. 입력 $u(t)$에 대한 출력이 $y(t)$인 system에 $ku(t)$를 입력하면 $ky(t)$가 튀어나오는, $u_1(t)+u_2(t)$의 입력에 대해서는 각각의 출력의 합인 $y_1(t)+y_2(t)$를 확인할 수 있는 시스템이 선형입니다.


Transfer function의 입장에서 시스템이 선형이라는 것은, 내가 입력하는 $u(t)$, 입력에 따라 Transfer function이 달라지지 않는다는 것을 의미합니다. Non-linear한 경우 주어지는 입력값에 따라 Transfer function이 달라집니다. 본 강의에서는 Non-linear한 system에 대해서는 다루지 않으므로, 여기서 개념만 알고 넘어가면 됩니다.


### 시불변(Time Invarient)


시불변이라는 것은, input이 입력된 시점에 관련없이 출력이 동일하게 나온다는 것을 의미합니다. 쉽게 생각하여 0초에 $u(t)$를 인가하여 $y(t)$를 얻었다면, $\sigma$초 delay된 입력 $u(t+\sigma)$에 대한 출력으로 $y(t+\sigma)$를 기대할 수 있다는 것입니다. 이 또한 사실 쉽게 이해되는 것이, 멈춰 있는 드론을 띄우는 command를 지금 하든, 5초 후에 하든 그 결과는 시간이 delay되었다는 것 말고는 동일해야 하니까요.


Transfer function의 입장에서 Time invarient하다는 것은, 원래의 differential equation의 계수가 time-invarient함을 의미합니다. 계수들이 $(a_i(t), b_i(t))$로 시간에 따라 바뀌는 system은 time-varient한 system이라고 볼 수 있습니다. 이러한 system 역시 본 강의에서는 다루지 않으므로 넘어가도 좋습니다.


### Transfer function의 종류

- Rational transfer function
위에서 다룬 Transfer function과 같이 transfer function의 분자와 분모를 다항식으로 나타낼 수 있는 transfer function을 rational transfer function이라고 부릅니다. Rational transfer function이면 LTI system입니다. 어찌 보면 당연한 일입니다.
- Proper, bi-proper transfer function
위 예시에서 $n, m$은 각각 $y, u$의 미분 차수의 최고차수입니다. 이 때 $n>m$인 경우를 proper transfer function, $n=m$인 경우를 bi-proper transfer function이라 합니다. $n<m$인 경우는 본 강의에서 다루지 않습니다.
- Time delay system
Laplace 변환의 T-shifting으로부터 $f(t-a)$의 Laplace transform은 $e^{-as}F(s)$임을 알고 있습니다. 이로부터, Transfer function 자체가 $e^{-as}$라면, a만큼의 delay를 주는 system으로 이해할 수 있을 것입니다.

> $$  
> T(s) = e^{-as}\\  
> y(t) = u(t-a)$$


# Connecting TF


Transfer function이라는 말이 길기 때문에 줄여서 TF라고 쓰겠습니다. 앞서 TF의 장점이 시스템을 연결하는 과정이 매우 간단하다고 언급하였는데, 왜 그런지 여기서 확인해볼 수 있습니다.


### 직렬 연결


![2](/2.png)


P(s)와 Q(s)를 직렬연결하면, 어떻게 될까요? 전체의 TF는 두 TF의 곱입니다. 조금만 생각해 봐도 알 수 있는 것이, P(s)의 output이 Q(s)이 input이 되는 꼴이므로, 둘을 곱하면 중간 변수가 없어지고 맨 처음 input에 대한 최종 output의 transfer function이 구해지겠습니다.


> $$  
> T(s) = P(s)Q(s)$$


### 병렬 연결


![3](/3.png)


저는 처음 생각할 때 한참 헤메긴 했습니다만, 이 또한 원리를 생각하면 간단합니다. 병렬로 연결한다는 것은 결국 $u(t)$를 각각의 plant에 똑같이 입력시키고, 출력한 신호 $y_p(t)$, $y_q(t)$를 합친다는 이야기거든요. Transfer function의 정의를 생각하면 각각의 transfer function의 정의로부터 두 신호의 합은 TF의 합이라는 사실을 금방 도출해낼 수 있습니다.


> $$  
> T(s) = P(s) + Q(s)$$


### Feedback System


![4](/4.png)


그렇다면 다음과 같은 Feedback system의 Transfer function은 어떻게 구할 수 있을까요? 여기서는, P(s)의 앞에 보조변수$e(t)$를 하나 두어서 쉽게 해결이 가능합니다. Feedback된 값을 원래의 입력 $u(t)$와 합친 이후에 실제로 P(s)에 들어가는 입력을 $e(t)$, 그 신호의 Laplace 변환을 $E(s)$라고 하면,


P(s), C(s)의 정의로부터,


> (3)  
> $$\begin{aligned}  
> &P(s) = \displaystyle\frac{Y(s)}{E(s)} \\ \\  
> &C(s) = \displaystyle\frac{U(s)-E(s)}{Y(s)}\end{aligned}$$


여기서 보조변수 $E(s)$를 소거하고, 전체 출력에 대한 전체 입력의 TF를 구하면,


> $$\begin{aligned}  
> E(s) &= U(s)-C(s)Y(s) \\  
> Y(s) &= P(s)E(S)\\  
> T(s) &= \displaystyle\frac{Y(s)}{U(s)} = \frac{P(s)}{1+P(s)C(s)}  
> \end{aligned}$$


여기서, 식 (3)의 맨 첫줄을 주목해 봐야하는데요, $E(s)$가, $U(s)$에서 Controller의 출력(Controller의 TF와 출력의 Laplace Transform의 곱)을 뺏다는 것을 알 수 있습니다. Feedback된 값에 ( - ) 부호를 붙여서 negative feedback을 하는 것이 기본적인 듯 합니다. 당연히도 controller의 존재 목적은 오차를 줄이는 것이지 오차를 키우는 것이 아니니까요.


여기서 사용된 P, C는 각각 Plant와 Controller의 약자를 의도하고 사용된 것입니다. Feedback system에서는 Plant와 Controller를 P, C로 표시하는 경우가 정말 많은데, 이 또한 notation에 지나지 않으니 상황에 따라 다르게 사용될 수 있습니다.


# Using Laplace Transform


우리가 Transfer function으로부터 $u(t)$, 혹은 $y(t)$를 구하려면 Laplace transform과 그 Inverse를 필연적으로 수행해야 합니다. 단순히 공식에 대입하여 적분하는 방법으로 수행할 수 있겠지만, Laplace transform에 관한 유용한 성질을 알고 있으면 단순 적분만은 반복하지 않고도 간단히 계산할 수 있을 것입니다. 이 부분은 공학수학에서 가져온 것으로, Transfer function의 계산과 관련된 연산에서 유용하게 사용될 수 있는 성질을 정리한 것입니다.


### Convolution


Laplace transform에서는 선형성이 성립합니다. 그렇지만 두 함수의 곱의 Laplace transform은, 각각의 변환된 값의 곱은 아니죠. 대신 두 함수의 Convolution은, 각각의 Laplace transform의 곱입니다.


> $$\begin{aligned}  
> \text{(convolution) }(f* g)(t) &\leftrightarrow F(s)G(s)\\  
> (f* g)(t) &:= \displaystyle\int_0^t f(\tau) g(t-\tau)dt  
> \end{aligned}$$


### Impulse response


만약 Transfer function에 Impulse($\delta(t)$)를 집어넣으면 어떻게 될까요? 물리적으로 Impulse는 충돌, 혹은 한번 꽝 치는 것을 말하고, 수학적으로는 디락 델타 함수(Dirac's delta function)으로 표현이 됩니다. 0을 주위로 면적이 1인 직사각형을 그리고 밑변의 길이를 양쪽에서 0으로 보내면, 0에서 값이 $\infty$고, 나머지에서는 0이지만 그 면적(적분값)은 1인 디락델타 함수가 됩니다. 이를 System에 인가한다고 가정하고, response를 구해보면,


> (4)  
> $$\begin{aligned}  
> Y(s) &= P(s)U(s) = P(s) \times 1 \\  
> y(t) &= p(t)\end{aligned}$$


식 (4)와 같이 디락 델타함수의 Laplace transform은 "1"이기 때문에, 출력값은 Transfer function의 inverse transform 이 됨을 알 수 있습니다. 입력 신호로 Dirac's delta function을 인가하면, TF의 역변환을 얻어내므로, system에 대한 모든 정보를 디락델타함수 하나의 입력으로 (물리적으로 해석하면 매우 세게 시스템을 한대 쳐서) 얻어낼 수 있다는 사실이 참 신기합니다. 그러나 이러한 입력은 이론상으로만 가능한 값이고, 실제로 저런 입력 신호를 구현할 수도, 구현해도 system이 버티지 못할 수도 있겠지요.


### Laplace transform 공식들


다음은, 알아두면 좋을 만한 Laplace transform의 공식들입니다. 후술하겠지만, 아래 공식들 정도만 인지하고 있어도 직접 적분할 필요 없이 partial fraction expansion을 통해 식을 전개하여 공식의 꼴로 분해하여 계산할 수 있습니다.


> $$\begin{aligned}  
> u(t)&\leftrightarrow 1/s \\  
> t\cdot u(t) &\leftrightarrow 1/s^2 \\  
> t^n \cdot u(t) &\leftrightarrow \displaystyle n! / s^{n+1} \\  
> e^{-\alpha t} &\leftrightarrow \displaystyle\frac 1 {s+a}\\  
> \sin\omega t &\leftrightarrow \displaystyle\frac{\omega} {s^2+\omega^2}\\  
> \cos\omega t &\leftrightarrow \displaystyle\frac{s} {s^2+\omega^2}\\  
> f(t-a) &\leftrightarrow e^{-as}F(s)  
> \end{aligned}$$


### Concrete example


그렇다면 실제로 어떤 Transfer function을 갖는 시스템에 대해 입력을 넣었을 때의 출력을 계산해 보겠습니다.


> $$  
> P(s) = \displaystyle\frac{1}{s+1}, \ u(t) = \sin{\omega t}$$


위와 같은 Plant에 $\omega$의 주파수를 가진 사인파를 인가하면 어떻게되는지, Laplace transform을 적용해봅시다.


> $$\begin{aligned}  
> Y(s) &= U(s)P(s) = \displaystyle\frac{\omega}{\omega^2+s^2} \times \frac{1}{s+1}\\  
> &= \displaystyle\frac{A}{s+1} + \frac{Bs+C}{s^2+\omega^2}  
> \end{aligned} $$


	Taking Inverse Laplace Transform,
$$
{% endraw %}
	y(t) = Ae^{-t}+ B \cos{\omega t} + \displaystyle\frac{C}{\omega} \sin{\omega t}$$


위 식에서 A, B, C는 항등식으로부터 계산가능한 '미정계수'입니다. 이를 구하는 Technique도 바로 다음에 다루겠습니다.


입력$u(t)$을 Transfer function $P(s)$를 갖는 plant에 넣었을 때의 출력을 구하였는데, A의 계수를 갖는 항과, B, C의 계수를 갖는 항들을 통해 일종의 추론, 혹은 짐작을 해볼 수 있는 요소들이 있습니다.


먼저는, $\omega$의 주파수를 갖는 입력에 대해서 출력의 주파수 또한 $\omega$를 유지했다는 사실입니다. 가장 첫번째 항 $Ae^{-t}$는 시간의 흐름에 따라 0으로 없어지므로, 두 번째와 세 번째 항은 주파수가 $\omega$입니다. 둘째로 $\cos$, $\sin$으로 이루어진 같은 주파수 항들은 공식에 의해 하나로 합성할 수 있습니다. 이 때 주파수에는 변화를 주지 않지만, $\pi$의 위상 변화가 생길 것이고, Magnitude 또한 바뀐다는 사실을 알 수 있습니다. 두 값은 $B$, $\displaystyle\frac{C}{\omega}$에 의해서 결정되므로, 두 값 모두 입력 신호의 주파수에 영향을 받는다는 것 까지 추론해볼 수 있습니다. 마지막으로, 맨 첫번째 항인 $Ae^{-t}$라는 항은 입력 신호가 아닌 System 자체에서 비롯된 것입니다. System 자체의 정보를 담고있는, 하지만 시간이 지남에 따라 0으로 수렴해 가는 항들을 Transient(일시적인) 이라고 불리며, 반대로 주기성을 가지고 오랜 시간이 흘러도 남아있는 항들을 steady-state response라고 할 수 있겠습니다.


# Partial Fraction Expansion


앞서 언급했듯이 Laplace transform의 inverse 공식에 따라 매번 적분하는 것 보다 위의 table을 활용하는 편이 더 빠르게 계산할 수 있을 겁니다. 더군다나, 많은 경우 우리가 계산해야 하는 Transfer function들은 Rational function이므로, Partial Fraction Expansion(부분분수 분해)가 굉장히 잘 되는 친구들입니다. 이 부분에서는 Technical하게 미정계수법을 하는 간단한 예시를 확인하고, 이를 공식화해보았습니다.


다음과 같은 $Y(s)$를 Partial Fraction Expansion 해보도록 합시다.


> $$  
> Y(s) = \displaystyle\frac{(s+3)}{(s+2)(s+1)} = \frac{A}{s+1} + \frac{B}{s+2}$$


	$$\begin{aligned}
	\\
	A &= \displaystyle\left.\frac{s+3}{s+2}\right\vert_{s=-1}\\B &= \displaystyle\left.\frac{s+3}{s+1}\right\vert_{s=-2}
	\end{aligned}$$


통분을 해서 A와 B를 구할 수도 있지만, (사실 이 과정을 축약한 것이기도 합니다만,) 위와 같은 공식에 의해 계산이 가능한 것을 알 수 있습니다. A는 $\displaystyle\frac{1}{s+1}$의 계수이므로, 원래의 식에서 해당 부분을 제외하고 나머지 값에 $\displaystyle\frac{1}{s+1}$의 분모를 0으로 만드는 $s=-1$을 대입하여 구할 수 있습니다.


이러한 공식이 항상 성립할까요? 중근(Repeated roots)에 대해서는 어떻게 계산이 가능한지 확인해보겠습니다.


> $$  
> Y(s) = \displaystyle\frac{(s+3)}{(s+2)(s+1)^3} = \frac{A}{s+1} + \frac{B}{s+2}+\frac{C}{(s+1)^2}+\frac{D}{(s+1)^3}$$


	$$\begin{aligned}\\
	D &= \displaystyle\left.\frac{s+3}{s+2}\right\vert_{s=-1} \\\\
	B &= \displaystyle\left.\frac{s+3}{(s+1)^3}\right\vert_{s=-2}\\\\
	C &= \displaystyle\left.\big(\frac{d}{ds}\frac{s+3}{s+2}\big)\right\vert_{s=-1}\\\\
	A &= \displaystyle\left.\frac{1}{2}\big(\frac{d^2}{ds^2}\frac{s+3}{s+2}\big)\right\vert_{s=-1}
	\end{aligned}$$


D와 B는 사실 앞서의 예제로부터 충분히 추론이 가능합니다. 여기서 눈여겨 봐야할 것은 C와 A인데, 위 식에서 $(s+1)$이 분모에 3번 중첩이 되었습니다. 중첩된 횟수를 n이라고 하면 $\frac{1}{(s+1)^i}$에 대한 미정계수는 $(s+1)^3$ 전부를 통채로 뺀 그 식(D에 해당하는)을 s에 대해 $n-i$번 미분한 값에 $s=-1$을 대입한 것과 같습니다. 추가로 미분할 때 계수가 계속 떨어져 나오므로 $(n-1)!$로 나누어 주어야 합니다. 말은 어려운데, 식으로 보면 그렇게 어렵지 않습니다.


일반화하여서, $(s-\alpha)$가 $n$번 중첩된 해의 $n-k$의 partial fraction의 계수 $A_K$는,


> $$  
> A_k = \displaystyle\left.\frac{1}{(n-1)!}\bigg(\frac{d^{(n-1)}}{ds^{(n-1)}}Y(s)(s-\alpha)^{n}\bigg)\right\vert_{s=-\alpha}$$


_여담인데.. 이거 어디서 많이 보지 않았나요.._
Laurent Series의 residue($a_ {-1}$)를 구하는 공식과 동일하죠. 저도 수업들을 때는 몰랐는데, 공업수학에서 복소해석을 공부하다보니 식의 꼴이 같은게 눈에 보이네요. 사실 Partial fraction expansion하는것도 분모의 pole(Analytic하지 않은 부분)을 따로 떼어내서 series형태로 만드는 작업이다 보니 같을 수밖에 없나봅니다.


물론 이 식을 외울 필요도, 유도할 필요도 없습니다. 사실 시험장에서 PFE를 할 일이 크게 없어서, 이러한 식으로 계수를 구할 수 있다는 것을 알고있는 정도로만도 충분할 것 같습니다. 물론 기억이 안나면 전부 통분해서 전개하여 항등식을 풀어줘도 됩니다.


# ❗ 결론


3가지의 Modeling 방법을 이 글을 통해 이해할 수 있었습니다. 특히 Transfer function에 대해 더 자세히 알아봤는데, Differential Equation을 Transfer function으로 변환하고, 입력과 TF가 주어졌을 때 출력을 계산하는 방법을 확인했습니다. 다음 시간에는 Transfer function의 관점에서 조금 더 심화하여 Bode plot을 어떻게 해석하고, reference가 있는 경우 어떻게 Linearization하는지 살펴보겠습니다.


### 🍪Comment


2번째라 속도가 좀 붙네요!🙂

