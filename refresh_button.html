<input id="token" type="password" placeholder="GitHub 토큰 입력" />

<button id="triggerButton">갱신</button>
<div id="message"></div>

<script>
document.getElementById("triggerButton").addEventListener("click", function() {
  const token = document.getElementById("token").value.trim();
  const messageElement = document.getElementById("message");

  if (!token) {
    messageElement.textContent = "토큰을 입력해야 실행할 수 있습니다.";
    return;
  }

  messageElement.textContent = "요청 전송 중...";

  var xhr = new XMLHttpRequest();
  xhr.open("POST", "https://api.github.com/repos/celenort/celenort.github.io/dispatches", true);
  xhr.setRequestHeader("Accept", "application/vnd.github.v3+json");
  xhr.setRequestHeader("Authorization", "Bearer " + token); // 입력값 사용
  xhr.setRequestHeader("Content-Type", "application/json");

  xhr.onload = function() {
    if (xhr.status === 204) {
      messageElement.textContent = "성공적으로 실행됨 (status " + xhr.status + ")";
    } else {
      messageElement.textContent = "실패 (status " + xhr.status + ")";
    }
  };

  xhr.onerror = function() {
    messageElement.textContent = "알 수 없는 오류 발생";
  };

  xhr.send(JSON.stringify({"event_type": "RUN_WORKFLOW_DISPATCH"}));
});
</script>
